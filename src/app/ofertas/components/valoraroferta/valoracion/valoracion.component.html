<br>
<div class="container bg-white">
    <br>
    <h1>Valorar Oferta</h1>
    <div class="row justify-content-center br ">
        <img src="./../../../../../assets/ImagenesAgroApoya2Admin/barra5.png" style="width: 65%;">
    </div>
    <div class="row justify-content-center br tarjetadetalle" *ngFor="let oferta of DataOferta">
        <div class="row m-2">
            <div class="col-sm-3">
                <img src={{RutaImagen+oferta.IMAGEN}} class="col-sm-12 ImgOferta">
            </div>
            <div class="col-sm-9">
                <div class="row">
                    <div class="col-sm-12">
                        <div class="row">
                            <div class="col-sm-12">
                                <label class="Llave TextMay">Codigo oferta:&nbsp;</label><label class="ValorIDOfer"><strong>{{oferta.COD_OFR_PUBLICO}}</strong></label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="row">
                            <div class="col-sm-12">
                                <label class="Llave">Producto:&nbsp;</label><label class="Valor">{{oferta.Nombre_Producto}}</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="row">
                            <div class="col-sm-12">
                                <label class="Llave">Presentación empaque:&nbsp;</label><label class="Valor">{{oferta.Descripcion_empaque}}</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="row">
                            <div class="col-sm-12">
                                <label class="Llave">Tamaño:&nbsp;</label><label class="Valor">{{oferta.Nmbre_tamano}}</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="row">
                            <div class="col-sm-12">
                                <label class="Llave">Condición entrega:&nbsp;</label> <label class="Valor">{{oferta.Condicion_entrega}}</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <div class="row">
                            <div class="col-sm-12">
                                <label class="Llave">Valor unidad:&nbsp;</label><label class="Valor">{{oferta.VR_UNDAD_EMPQUE}}</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="row">
                            <div class="col-sm-12">
                                <label class="Llave">Unidades disponibles:&nbsp;</label><label class="Valor">{{oferta.Unidades_disponibles}}</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-6">
                        <label class="Llave">Valor total oferta:&nbsp;</label><label class="Valor">{{oferta.VR_TOTAL_OFRTA}}</label>
                    </div>
                    <div class="col-sm-6">
                        <label class="Llave">Valor costeo:&nbsp;</label><label class="Valor">{{oferta.vlor_costeo}}</label>
                    </div>
                </div>
                <hr class="hrSinEstilo">
                <div class="row">
                    <div class="col-sm-12">
                        <label class="Llave">Descripción producto:&nbsp;</label><label class="Valor">{{oferta.caracteristicas}}</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <label class="Llave">Caracterización:&nbsp;</label><label class="Valor">{{oferta.caracterizacion}}</label>
                    </div>
                </div>
                <hr class="hrSinEstilo">
                <div class="row">
                    <div class="col-sm-6">
                        <div class="row">
                            <div class="col-sm-12">
                                <label class="Llave">Fecha recogida:&nbsp;</label><label class="Valor">{{oferta.fecha_recogida}}</label>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-6">
                        <div class="row">
                            <div class="col-sm-12">
                                <label class="Llave">Jornada:&nbsp;</label><label class="Valor">{{oferta.Nombre_jornada}}</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <label class="Llave">Nombre productor:&nbsp;</label><label class="Valor">{{oferta.Nombre_productor}}</label>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <div class="row">
                            <div class="col-sm-12">
                                <label class="Llave">Ubicación:&nbsp;</label><label class="Valor">{{oferta.Ubicacion_parsela +' ('+oferta.coordenadas_parcela}})</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-12">
                        <div class="col-sm-12">
                            <label class="Llave">Estado:&nbsp;</label><label class="Valor">{{oferta.Nombre_estado}}</label>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="row br">
        <h5 class="SubTituloForm">Definición vigencia oferta</h5>
    </div>
    <div class="row br">
        <ngb-accordion #acc="ngbAccordion" activeIds="config-panel-three">
            <ngb-panel title="Definición vigencia oferta" id="config-panel-three">
                <ng-template ngbPanelContent>
                    <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Vigencia desde</label>
                            <input type="date" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="VigenDesde">
                        </div>
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Vigencia hasta</label>
                            <input type="date" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="VigenHasta">
                        </div>
                    </div>
                    <!-- <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Hora inicio oferta</label>
                            <input type="time" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="HoraIni">
                        </div>
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Hora fin oferta</label>
                            <input type="time" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="HoraFin">
                        </div>
                    </div> -->
                    <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Fecha entrega</label>
                            <input type="date" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="FechaEntrega">
                        </div>
                    </div>
                    <div class="row br">
                        <div class="col-sm-12">
                            <label class="col-sm-12 Llave">Observaciones</label>
                            <textarea class="col-sm-12 form-control mt-1 textArea" cols="30" rows="3" [(ngModel)]="Observaciones"></textarea>
                        </div>
                    </div>
                    <div class="row justify-content-center br">
                        <div class="col-sm-2 ">
                            <button class="btn btn-agro-prin col-sm-12" (click)="GuardaVigencia(ModalRespuesta)">Guardar</button>
                        </div>
                    </div>
                </ng-template>
            </ngb-panel>
        </ngb-accordion>
    </div>
    <div class="row br" *ngIf="ValidaDefTipoOfer=='1'">
        <h5 class="SubTituloForm">Definición tipo oferta</h5>
    </div>
    <div class="row br" *ngIf="ValidaDefTipoOfer=='1'">
        <div class="col-sm-8">
            <label class="col-sm-12 Llave mb-1">Sector a valorizar</label>
            <ng-autocomplete [data]="DataSectores" [searchKeyword]="keywordSec" (selected)='selectSector($event)' (inputCleared)='LimpiaSector()' placeholder="Sector" [itemTemplate]="templateSec" [notFoundTemplate]="templateVacio">
            </ng-autocomplete>
            <ng-template #templateSec let-item>
                <a [innerHTML]="item.DSCRPCION_SCTOR"></a>
            </ng-template>
            <ng-template #templateVacio let-SinRegistro>
                <label for="">Sin registros</label>
            </ng-template>
        </div>
        <div class="col-sm-2">
            <label class="col-sm-12 Llave mb-1">Codigo oferta sector</label>
            <input type="text" name="" id="" class="form-control textBox" disabled [(ngModel)]="CodigoOferSector">
        </div>
        <div class="col-sm-2">
            <label class="col-sm-12 Llave mb-1">Valor flete sector</label>
            <input type="text" name="" id="" class="form-control textBox" disabled [(ngModel)]="VlrFletSect">
        </div>
    </div>
    <div class="row br" *ngIf="ValidaTipoOfer=='1'">
        <div class="col-sm-12">
            <label class="col-sm-12 Llave mb-1">Tipo oferta</label>
            <ng-autocomplete [data]="DataTipoOferta" [searchKeyword]="keyword" (selected)='selectTipOferta($event)' [initialValue]="ArrayTipoOferCon[0]" (inputCleared)='LimpiaTipoOferta($event)' placeholder="Individual, Grupal o Mixta" [itemTemplate]="templateOfer"
                [notFoundTemplate]="templateVacio">
            </ng-autocomplete>
            <ng-template #templateOfer let-item>
                <a [innerHTML]="item.name"></a>
            </ng-template>
            <ng-template #templateVacio let-SinRegistro>
                <label for="">Sin registros</label>
            </ng-template>
        </div>
    </div>
    <div class="row br">
        <ngb-accordion #acc="ngbAccordion" activeIds="config-panel-one" *ngIf="MuestraIndividual=='1'">
            <ngb-panel title="Compra individual" id="config-panel-one">
                <ng-template ngbPanelContent>
                    <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave mb-1">Tipo comisión</label>
                            <ng-autocomplete [data]="DataTipoComisiono" [searchKeyword]="keyword" [initialValue]="ArrayTipoComICon[0]" (inputCleared)='LimpiaTipoComisionI($event)' (selected)='selectTipComiI($event)' placeholder="Fija o por Porcentaje" [itemTemplate]="templateSec"
                                [notFoundTemplate]="templateVacio">
                            </ng-autocomplete>
                            <ng-template #templateSec let-item>
                                <a [innerHTML]="item.name"></a>
                            </ng-template>
                            <ng-template #templateVacio let-SinRegistro>
                                <label for="">Sin registros</label>
                            </ng-template>
                        </div>
                        <div class="col-sm-6" *ngIf="MuestraPorcentaje=='1'">
                            <label class="col-sm-12 Llave">Valor comisión porcentaje</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" min="1" max="100" onkeyup="if(parseInt(this.value)>100){ this.value=100; return false; }" [(ngModel)]="VlrComPorI" (change)="CalcuPreFinInd()">
                        </div>
                        <div class="col-sm-6" *ngIf="MuestraFijo=='1'">
                            <label class="col-sm-12 Llave">Valor comisión fija</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="VlrComFijaI" (change)="CalcuPreFinInd()">
                        </div>
                    </div>
                    <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Minimo unidades</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="MinUnidI">
                        </div>
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Maximo unidades</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="MaxUnidI">
                        </div>
                    </div>
                    <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Valor domicilio</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="VlrDomiI">
                        </div>
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Precio final (No incluye valor domicilio)</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="PreFinI" disabled="true">
                        </div>
                    </div>
                    <div class="row br">
                        <div class="col-sm-12">
                            <label class="col-sm-2 Llave">Descuentos adicionales</label>
                            <button class="bot col-sm-1 SinEstilo">
                                <img src="../../../../../assets/ImagenesAgroApoya2Admin/lupa.png" alt="Agregar descuento adicional">
                            </button>
                        </div>
                    </div>
                    <div class="row justify-content-center br" *ngIf="MuestraBtnIndividual=='1'">
                        <div class="col-sm-3">
                            <button class="btn btn-agro-prin col-sm-12" (click)="GuardaIndividual(ModalRespuesta)">Guardar individual</button>
                        </div>
                    </div>
                </ng-template>
            </ngb-panel>
        </ngb-accordion>
        <ngb-accordion #acc="ngbAccordion" activeIds="config-panel-two" *ngIf="MuestraGrupal=='1'">
            <ngb-panel title="Compra grupal" id="config-panel-two">
                <ng-template ngbPanelContent>
                    <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave mb-1">Tipo comisión</label>
                            <ng-autocomplete [data]="DataTipoComisiono" [searchKeyword]="keyword" (inputCleared)='LimpiaTipoComision($event)' [initialValue]="ArrayTipoComGCon[0]" (selected)='selectTipComiG($event)' placeholder="Fija o por Porcentaje" [itemTemplate]="templateSec"
                                [notFoundTemplate]="templateVacio">
                            </ng-autocomplete>
                            <ng-template #templateSec let-item>
                                <a [innerHTML]="item.name"></a>
                            </ng-template>
                            <ng-template #templateVacio let-SinRegistro>
                                <label for="">Sin registros</label>
                            </ng-template>
                        </div>
                        <div class="col-sm-6" *ngIf="MuestraPorcentaje=='1'">
                            <label class="col-sm-12 Llave">Valor comisión porcentaje</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" min="1" max="100" onkeyup="if(parseInt(this.value)>100){ this.value=100; return false; }" [(ngModel)]="VlrComPorG" (change)="CalculaPreoferGrupalM()">
                        </div>
                        <div class="col-sm-6" *ngIf="MuestraFijo=='1'">
                            <label class="col-sm-12 Llave">Valor comisión fija</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="VlrComFijaG" (change)="CalculaPreoferGrupalM()">
                        </div>
                    </div>
                    <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Minimo unidades lider</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="MinUnidLider" onkeyup="if(this.value==''){this.value=0; return false; }">
                        </div>
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Maximo unidades lider</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="MaxUnidLider" onkeyup="if(this.value==''){this.value=0; return false; }">
                        </div>
                    </div>
                    <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Minimo unidades participante</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="MinUnidPart" onkeyup="if(this.value==''){this.value=0; return false; }">
                        </div>
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Maximo unidades participante</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="MaxUnidPart" onkeyup="if(this.value==''){this.value=0; return false; }">
                        </div>
                    </div>
                    <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Valor domicilio</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="VlrDomiG" onkeyup="if(this.value==''){this.value=0; return false; }" (change)="CalculaPreoferGrupalM()">
                        </div>
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Porcentaje descuento lider</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" onkeyup="if(parseInt(this.value)>100){ this.value=100; return false; }" [(ngModel)]="PorcDescLider">
                        </div>
                    </div>
                    <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Cantidad de grupos</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="CantGrupos" onkeyup="if(this.value==''){this.value=1; return false; }" (change)="CalculaCCI(ModalRespuesta)">
                        </div>
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Numero minimo de personas por grupo</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="UnidXGrupos" onkeyup="if(this.value==''){this.value=2; return false; }" (change)="CalculaCCI(ModalRespuesta)">
                        </div>
                    </div>
                    <div class="row br" *ngIf="MuestraCantIndiv=='1'">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Cantidad de compras individuales</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="CantComprI" disabled="true">
                        </div>
                    </div>
                    <div class="row br">
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Precio arranque lider</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="PrecioFinLider" disabled="true">
                        </div>
                        <div class="col-sm-6">
                            <label class="col-sm-12 Llave">Precio final participante</label>
                            <input type="number" class="col-sm-12 form-control mt-1 textBox" [(ngModel)]="PrecioFinPart" disabled="true">
                        </div>
                    </div>
                    <div class="row br">
                        <div class="col-sm-12">
                            <label class="col-sm-2 Llave">Descuentos adicionales</label>
                            <button class="bot col-sm-1 SinEstilo">
                                <img src="../../../../../assets/ImagenesAgroApoya2Admin/lupa.png" alt="Agregar descuento adicional">
                            </button>
                        </div>
                    </div>
                    <div class="row justify-content-center br" *ngIf="MuestraBtnGrupal=='1'">
                        <div class="col-sm-3">
                            <button class="btn btn-agro-prin col-sm-12" (click)="GuardaGrupal(ModalRespuesta)">Guardar grupal</button>
                        </div>
                    </div>
                    <div class="row justify-content-center br" *ngIf="MuestraBtnMixta=='1'">
                        <div class="col-sm-3">
                            <button class="btn btn-agro-prin col-sm-12" (click)="GuardarMixta(ModalRespuesta)">Guardar mixta</button>
                        </div>
                    </div>
                </ng-template>
            </ngb-panel>
        </ngb-accordion>
    </div>

    <div class="row justify-content-center br">        
        <div class="col-sm-3">
            <button class="btn btn-agro-prin col-sm-12" (click)="AbrePublica(ModalPublicar)">Publicar oferta</button>
        </div>
    </div>
    <br>
    <br>
    <br>
    <br>    
</div>
<ng-template #ModalRespuesta let-modal>
    <div class="modal-header">
        <h1>Respuesta</h1>
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss()"></button>
    </div>
    <div class="modal-body">
        <div class="row br">
            <div class="col-sm-12">
                <h2 class="TituloDetalle">{{Respuesta}}</h2>
            </div>
        </div>
    </div>
    <div class="row justify-content-center">
        <button type="button" class="btn btn-agro-prin col-sm-2" (click)="modal.close()">Aceptar</button>
    </div>
    <br>
</ng-template>
<ng-template #ModalPublicar let-modal>
    <div class="modal-header">
        <h1 class="modal-title" id="modal-basic-title">Publicar Oferta</h1>        
        <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss()"></button>
    </div>
    <div class="modal-body">
        <div class="row br">
            <div class="col-sm-12">
                <textarea [(ngModel)]="PubliOferObser" class="Col-sm-12 form-control textArea" placeholder="Observaciónes" rows="3"></textarea>
            </div>
        </div>        
    </div>
    <div class="row justify-content-center">
        <button type="button" class="btn btn-agro-prin col-sm-2" (click)="PublicaOferta(ModalRespuesta)">Guardar</button>
    </div>
    <br>
</ng-template>